# Стратегия

Простой балансировщик портфелей. Есть реальный и виртуальный портфель.

```ts
const wallet {
  AAPL: 10,
  USD: 1000,
};

const desiredWallet {
  AAPL: 50%,
  USD: 50%,
};
```

1. Конвертируем Wallet в проценты.
walletToPercent(wallet: Wallet): Wallet

2. Сортируем по цене лотов, чтобы балансировать сначала позиции с самыми дорогими лотами.

3. Балансируем, начиная с позиций от дорогих лотов к дешевым.

3.1. Если надо докупить акции, то пытаемся долить акции до первого перелива стакана.
3.2. Считаем разницу между первым недоливом и рефересным значением и первым переливом и рефересным значением.
3.3. Выбираем ту сторону, где значение будет ближе к референсному.

С продажами делаем аналогично.

4. Результат

```ts
const balancerWallet {
  AAPL: 2,
  USD: -400,
};
```

5. Фильтруем валюты.

```ts
const balancerWalletInstruments {
  AAPL: 2,
};
```

6. Отправляем приказы в работу. Отслеживаем выполнение.
